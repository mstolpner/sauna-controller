<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="{{ csrf_token() }}">
    <title>Settings - Sauna Controller</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>Settings</h1>
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab-button active" onclick="switchTab('user')">User</button>
            <button class="tab-button" onclick="switchTab('system')">System</button>
        </div>

        <!-- User Tab Content -->
        <div id="user-tab" class="tab-content active">
            <div class="settings-scroll">
                <div class="settings-content">
                <h3 class="section-title">Temperature Settings</h3>
                <div class="setting-item">
                    <label>Max Hot Room Temperature, °F:</label>
                    <input type="number" id="max-temp" min="100" max="300" value="240">
                </div>
                <div class="setting-item">
                    <label>Preset Medium Hot Room Temperature, °F:</label>
                    <input type="number" id="preset-medium" min="100" max="250" value="180">
                </div>
                <div class="setting-item">
                    <label>Preset High Hot Room Temperature, °F:</label>
                    <input type="number" id="preset-high" min="100" max="250" value="200">
                </div>
                <div class="setting-item">
                    <label>Heater On Lower Temperature Threshold, °F:</label>
                    <input type="number" id="lower-threshold" min="0" max="50" value="5">
                </div>
                <div class="setting-item">
                    <label>Heater Off Upper Temperature Threshold, °F:</label>
                    <input type="number" id="upper-threshold" min="0" max="50" value="0">
                </div>
                <div class="setting-item">
                    <label>Hot Room Cooling Grace Period, minutes:</label>
                    <input type="number" id="cooling-grace-period" min="0" max="10" value="1">
                </div>

                <h3 class="section-title">Heater Health Check Settings</h3>
                <div class="setting-item">
                    <label>Heater Health Check Warmup Time, minutes:</label>
                    <input type="number" id="warmup-time" min="0" max="30" value="5">
                </div>
                <div class="setting-item">
                    <label>Heater Health Check Cooldown Time, minutes:</label>
                    <input type="number" id="cooldown-time" min="0" max="60" value="20">
                </div>
                <div class="setting-item">
                    <label>Heater Max Safe Runtime, minutes:</label>
                    <input type="number" id="max-safe-runtime" min="0" max="1440" value="240">
                </div>

                <h3 class="section-title">Heater Cycle Control Settings</h3>
                <div class="setting-item">
                    <label>Heater Cycle On Period, minutes:</label>
                    <input type="number" id="cycle-on-period" min="0" max="60" value="30">
                </div>
                <div class="setting-item">
                    <label>Heater Cycle Off Period, minutes:</label>
                    <input type="number" id="cycle-off-period" min="0" max="60" value="15">
                </div>

                <h3 class="section-title">Hot Room Light Settings</h3>
                <div class="setting-item">
                    <label>Turn Hot Room Light Off When Sauna is Off:</label>
                    <input type="checkbox" id="light-off-when-sauna-off" class="setting-checkbox">
                </div>

                <h3 class="section-title">Display Settings</h3>
                <div class="setting-item">
                    <label>Display Brightness:</label>
                    <input type="range" id="display-brightness" class="slider" min="0" max="255" value="255" step="1">
                </div>
            </div>
            </div>
        </div>

        <!-- System Tab Content -->
        <div id="system-tab" class="tab-content">
            <div class="settings-scroll">
                <div class="settings-content">
                <h3 class="section-title">System Settings</h3>
                <div class="setting-item">
                    <label>Current CPU Temperature, °C:</label>
                    <span id="cpu-temp-current" class="readonly-value">--</span>
                </div>
                <div class="setting-item">
                    <label>CPU Temperature Warning Threshold, °C:</label>
                    <input type="number" id="cpu-temp-warn" min="50" max="100" value="90">
                </div>
                <div class="setting-item">
                    <label>Max Sauna On Time, hours:</label>
                    <input type="number" id="max-sauna-on-time" min="0" max="24" value="6">
                </div>
                <div class="setting-item">
                    <label>Logging Level:</label>
                    <select id="log-level" class="setting-select">
                        <option value="10">DEBUG</option>
                        <option value="20">INFO</option>
                        <option value="30" selected>WARNING</option>
                        <option value="40">ERROR</option>
                        <option value="50">CRITICAL</option>
                    </select>
                </div>

                <h3 class="section-title">Modbus Communication Settings</h3>
                <div class="setting-item">
                    <label>Modbus Serial Port:</label>
                    <input type="text" id="serial-port" value="/dev/ttyAMA0">
                </div>
                <div class="setting-item">
                    <label>Modbus Baud Rate:</label>
                    <input type="number" id="baud-rate" min="1200" max="115200" value="9600">
                </div>
                <div class="setting-item">
                    <label>Modbus Timeout, seconds:</label>
                    <input type="number" id="modbus-timeout" min="0.1" max="5" step="0.1" value="0.3">
                </div>
                <div class="setting-item">
                    <label>Modbus Retries:</label>
                    <input type="number" id="modbus-retries" min="0" max="10" value="3">
                </div>

                <h3 class="section-title">Modbus Register Addresses</h3>
                <div class="setting-item">
                    <label>Temperature Sensor Address:</label>
                    <input type="number" id="temp-sensor-addr" min="0" max="255" value="1">
                </div>
                <div class="setting-item">
                    <label>Humidity Sensor Address:</label>
                    <input type="number" id="humidity-sensor-addr" min="0" max="255" value="0">
                </div>
                <div class="setting-item">
                    <label>Heater Relay Coil Address:</label>
                    <input type="number" id="heater-relay-coil-addr" min="0" max="255" value="0">
                </div>
                <div class="setting-item">
                    <label>Hot Room Light Coil Address:</label>
                    <input type="number" id="hot-room-light-coil-addr" min="0" max="255" value="1">
                </div>
                <div class="setting-item">
                    <label>Right Fan Relay Coil Address:</label>
                    <input type="number" id="right-fan-relay-coil-addr" min="0" max="255" value="2">
                </div>
                <div class="setting-item">
                    <label>Left Fan Relay Coil Address:</label>
                    <input type="number" id="left-fan-relay-coil-addr" min="0" max="255" value="3">
                </div>
                <div class="setting-item">
                    <label>Fan Module Room Temp Address:</label>
                    <input type="number" id="fan-module-room-temp-addr" min="0" max="255" value="0">
                </div>
                <div class="setting-item">
                    <label>Fan Status Address:</label>
                    <input type="number" id="fan-status-addr" min="0" max="255" value="1">
                </div>
                <div class="setting-item">
                    <label>Fan Speed Address:</label>
                    <input type="number" id="fan-speed-addr" min="0" max="255" value="3">
                </div>
                <div class="setting-item">
                    <label>Number of Fans Address:</label>
                    <input type="number" id="number-of-fans-addr" min="0" max="255" value="6">
                </div>
                <div class="setting-item">
                    <label>Fan Fault Status Address:</label>
                    <input type="number" id="fan-fault-status-addr" min="0" max="255" value="14">
                </div>
                <div class="setting-item">
                    <label>Fan Module Governor Address:</label>
                    <input type="number" id="fan-module-governor-addr" min="0" max="255" value="32">
                </div>
                <div class="setting-item">
                    <label>Fan Module Reset Governor Value:</label>
                    <input type="number" id="fan-module-reset-governor-value" min="0" max="255" value="170">
                </div>
            </div>
            </div>
        </div>

        <!-- Save and Back Buttons -->
        <div class="button-container">
            <button class="ok-btn" onclick="saveSettings()">Save</button>
            <button class="ok-btn secondary-btn" onclick="window.location.href='/'">Cancel</button>
        </div>
    </div>

    <script src="/static/js/settings.js"></script>
</body>
</html>
